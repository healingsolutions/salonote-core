jQuery(function(){jQuery(".event_manager_image_upload").on("click",function(e){var n;e.preventDefault();var i=$(this).attr("id"),t=i.replace("event_manager_form_","");if(n)return void n.open();console.log("click:"+i),n=wp.media({title:_wpMediaViewsL10n.mediaLibraryTitle,library:{type:"image"},button:{text:"画像を選択"},multiple:!1,frame:"select",editing:!0}),n.on("ready",function(){}),n.on("select",function(){var e=n.state().get("selection"),a=jQuery("#"+i),r=0,o=[];e.each(function(e){new_id=e.toJSON().id,jQuery.inArray(new_id,o)>-1&&a.find("li#img_"+new_id).remove(),console.log("select"+i),a.append('<p class="event_manager_img" id=img_'+new_id+'><a href="#" class="event_manager_image_remove" title="画像を削除する"></a><img src="'+e.attributes.sizes.thumbnail.url+'" /><input type="hidden" name="essence_event_manager['+t+'][menu_assets]" value="'+new_id+'" /></p>')})}),n.open()}),jQuery(".event_manager_image_remove").live("click",function(e){e.preventDefault(),e.stopPropagation(),img_obj=jQuery(this).parents("p.event_manager_img").remove()})});